# 面试总结

## 面试技巧

### 工作介绍

+ 负责CIM系统开发和维护, 保证系统24小时可靠稳定运行.
+ 维护生产管理，设备管理和品质管理等模块自动化运行和动态监控.
+ 和机台厂商,生产制造部门协商确定需求, 制定开发文档, 进行项目开发.

### 项目介绍

+ WIM智能办公系统(自己只是开发的一部分人员, 符合开发的基本规范, 假设存在一个前端, 一个组长, 自己作为后台开发) 开发流程: 收集需求, 指定需求说明文档, 制作原型, 开发第一版, 快速迭代.

+ BC系统向Java转型

### 离职原因

+ 职业发展方向不一样, 公司方向偏向于把我们培养成业务骨干, 维持生产的正常进行. 个人方向软件架构师(软件架构师是软件行业中一种新兴职业，工作职责是在一个软件项目开发过程中，将客户的需求转换为规范的开发计划及文本，并制定这个项目的总体架构，指导整个开发团队完成这个计划。主导系统全局分析设计和实施、负责软件构架和关键技术决策的人员.)

+ 工作偏运维, 技术相对保守稳定, 有一个现成的系统, 挑战性比较小. 个人喜欢挑战自己, 积极学习新的东西.

## 学习总结

### 深度

+ JDK源码尽快阅读(重点放在多线程那部分)

+ Mysql相关SQL调优学习

### 广度学习

+ Spring Cloud

+ OSGI了解并使用

+ Elasticsearch使用和应用

## 刷题补基础

### 自我和项目相关

#### 自我介绍

大家好，我是蔡剑勇，来自西南大学，软件工程专业. 个人性格偏向理性，开朗容易相处，喜欢学习新事物，性格有些急，不过工作这段时间改善很多了。平时喜欢写写代码，看看书，更新博客和健身。我认为身体和学习同样重要，平时工作的过程中，也经常抽出时间来健身，爬山，慢跑等。

#### 你觉得自己的优点是？你觉得自己有啥缺点？

优点有: 学习能力强, 适应性强: 在任何环境中都能很快适应下来, 并投入工作. 喜欢挑战自己: 喜欢尝试不同的事物, 挑战自己的极限. 团队协作性好: 可以较快地融入团队工作中,并贡献自己的一份力.

缺点有: 性格有时候有点急, 碰到一件事第一个想法就是马上解决, 不喜欢拖延.

#### 你有哪些 offer？

无.

#### 你为什么要离开上家公司？你上家公司在xxx，我们公司在xxx，离这么远为什么要选择我们这里？

+ 主要是职业发展方向不一样, 虽然上家公司也是很好的, 无论是技术方向和前景都是很不错的. 上家公司主要方向偏向于走物联网和工业互联网方向, 而我所在的岗位主要是负责物联的方向: 就是和机台通信, 自动化生产的方向. 这个对硬件的要求比较高, 侧重点在于如何把硬件和软件结合起来, 在维持生产的正常进行时, 来进行系统的开发. 而我个人的方向还是偏向喜欢纯软件, 个人方向还是想往软件架构师方向发展.(软件架构师是软件行业中一种新兴职业，工作职责是在一个软件项目开发过程中，将客户的需求转换为规范的开发计划及文本，并制定这个项目的总体架构，指导整个开发团队完成这个计划。主导系统全局分析设计和实施、负责软件构架和关键技术决策的人员.)

+ 第二就是公司技术相对保守稳定, 存在现成的系统, 对我来说挑战性比较小, 比如学习2-3个月, 就可以一直正常的工作了. 而我个人喜欢挑战自己, 积极学习新的东西.

#### 上家公司的同事和领导是怎么评价你的？

认真负责: 只要事情经过我的, 我都会持续跟踪下去.

#### 介绍下你的上家公司是做哪块的吧

+ 第一块就是负责CIM系统开发和维护, 保证系统24小时可靠稳定运行, 而我们也开发了各种各样的模块进行管理: 生产管理模块，设备管理模块和品质管理模块等等进行生产的监控.

+ 第二块主要是相关办公系统的开发, 开发部门相关的办公系统, 运维系统等.

#### 在上家公司你做了哪些项目？

+ WIM智能办公系统(自己只是开发的一部分人员, 符合开发的基本规范, 假设存在一个前端, 一个组长, 自己作为后台开发, 开发流程: 收集需求, 指定需求说明文档, 制作原型, 开发第一版, 快速迭代.)部门级别办公辅助系统, 提供运维信息管理,Issue录入,周报生成,工作量统计等多项辅助功能.

+ BC系统向Java转型, BC系统就是管理产线的系统, 每一个产线对应一个BC系统, BC系统控制着各种生产相关管理, 何时上货,何时下货,什么时候跑什么货等. 几百个BC系统连接在一起就变成我们现在的CIM系统. 之前的BC系统是使用C#编写的, 是跑在WindowsServer下使用SQL Server, FTP等进行部署的. 但是这个系统存在比较多的问题, 其中一个如:当我们要更新BC系统,上线新的需求的时候, 我们就必须停止产线生产, 这会造成严重的损耗. 后期我们的规划是转化为Java方向, 使用Linux+Java+Web的形式进行开发部署, 更新时通过OSGI进行无痛换版.

#### 你在项目中是什么角色？

WIM智能办公系统中主要是后台开发, 为前端提供Restful的方法调用. 有时候会协助前端进行页面撰写.

BC系统向Java转型项目, 主要是项目负责人.

#### 这个项目的数据量和并发量多大？

WIM智能办公系统就是传统的Web端的项目, 数据量和使用量为部门级别, 一共有4-5百人在使用, 高峰并发量可能达到100TPS.

BC系统向Java转型这个和传统的Web项目不太一样, 产线时时刻刻都在产生信息, 一个产品从上货到下货的需要成百上千的指令支持, 如上货请求, 上货信息下载, 开始命令等. 除了这些指令, 我们系统还需要定时收集机台信息, 产品信息进行后台动态监控等. 高峰交互可以达到500TPS.

#### 这个项目用的什么技术？

WIM智能办公系统: Spring Boot + Vue + SQL Server

BC系统向Java转型: Spring + Tomcat + OSGI

#### 项目过程中有遇到什么很印象深刻的问题吗？

BC系统向Java转型这个项目, 因为这个项目之前是C#写的, 要完全改写成Java版本, 就必须全部阅读底层代码, 明白它的系统架构和代码实现等. 之前接触过C#, 但是需要阅读一个完全用C#完成的系统, 这个挑战性还是很大的.

#### 是怎么解决的这些问题？

学习C#, 然后代码一行一行的看, 不同的就google对应的C#语法情况.

#### 项目有没有还可以继续优化的地方？

有时候BC系统的监控信息交互都是实时的, 这对BC系统有很多的负载请求. 而有些情况对及时性又不是非常严格的, 这时候使用一些合理的中间件, 如RabbitMQ, Kafaka进行中间转发,将会很好的解决这个问题.

对于有些BC系统中某些常用的信息, 如机台信息等都是可以使用内存数据库进行缓存的, 而不是直接访问数据库, 这时候可以使用Redis进行合理的应用.

#### 该怎么优化？有什么思路没？

同上.

#### 叫你设计一个并发xxx，数据存储量xxx 量级的系统，你该如何设计？从你知道的点尽可能的多说出些？

Spring Cloud.

### Java 基础

#### Object 对象的方法有哪些？分别有什么作用？该什么场景用？

+ getClass: 返回对象的Class类型
+ hashCode: 返回对象的哈希值
+ equals: 判断两个对象是否相等, 默认实现为引用判断
+ clone: 返回对象的拷贝, 深拷贝
+ toString: 字符串描述
+ notify: 唤醒等待该对象监视器的线程, 如果有多条线程, 随机唤醒一条.
+ notifyAll: 唤醒所有等待对象的监视器的线程.
+ wait: 线程放弃对象监视器所有权, 进入等待池中, 并等待唤醒.
+ finalize: 析构函数,当对象被回收时, 默认调用该函数.

#### Integer 的常量缓存池

默认缓存-128到127之间的Integer对象, 可以通过-XX:AutoBoxCacheMax设定上限.

#### Java 特性？什么是多态？举个例子

面向对象编程: 封装(相关信息操作封装起来,对外提供接口), 继承(通过继承可以获取父类的操作), 多态(动态绑定, 声明一个接口或者父类, 具体的实现由不同的子类完成.), 抽象(把事物的特征抽象成属性和方法).

#### 重载重写的区别？

重载: 相同方法名, 但是参数特征不一致.

重写: 覆盖父类的实现, `@Override`标识.

#### 画下 HashMap 的结构图？HashMap 、 HashTable 和 ConcurrentHashMap 的区别？使用场景分别是？

HashMap,HashTable: 数组 + 链表 . Java8新加功能: HashMap对于数组内的单个元素链表非常多(默认超过7个)的话, 将链表转化为红黑树(根节点为黑色, 黑色节点的子节点可以红或者黑, 红色节点的子节点一定为黑色, 保证根节点到达任何一个子节点的路径中黑色节点数量相同, 通过树的选择来实现), 而HashTable不会.

HashTable: 线程安全的, 读或者取都是需要获取对象实例锁, 效率较低.

ConcurrentHashMap: 线程安全的, HashTable的优化版本, 和HashTable提供相同的接口. Java7: 内部数据存在一个Segment数组中, 大小为16, Segment对象内部和HashMap类似, 为数组+链表, 内部可以扩容. 读取不加锁, 修改值的时候, 必须获取Segemnt的锁, 理论上最大支持16个线程同时修改. Java8: 实现还是使用数组+链表的实现方式(链表可能转变为红黑树), 通过对数组中链表的头结点进行加锁来保证同步性.

#### HashMap 中怎么解决冲突的？

取哈希值放到不同的桶里面, 如果存在的话, 以链表的形式挂在后面. 数量超过7个, 则转化为红黑树结果.

#### ConcurrentHashMap 和 HashTable 中线程安全的区别？为啥建议用 ConcurrentHashMap ？能把 ConcurrentHashMap 里面的实现详细的讲下吗？

HashTable: 线程安全的, 读或者取都是需要获取对象实例锁, 效率较低.

ConcurrentHashMap: 线程安全的, HashTable的优化版本, 和HashTable提供相同的接口. Java7: 内部数据存在一个Segment数组中, 大小为16, Segment对象内部和HashMap类似, 为数组+链表, 内部可以扩容. 读取不加锁, 修改值的时候, 必须获取Segemnt的锁, 理论上最大支持16个线程同时修改. Java8: 实现还是使用数组+链表的实现方式(链表可能转变为红黑树), 通过对数组中链表的头结点进行加锁来保证同步性.

#### 保证线程安全的还有其他的方式吗？

Synchronize, CAS, ThreadLocal,设计类为不变类,Volatile(只保证了可见性和有序性,不能保证原子性).

#### 讲下 Synchronized？

对象添加一个监视器锁, 每次进入时通过检查是否获取监视器锁.

#### 讲下 ReentrantLock 可重入锁？ 什么是可重入锁？为什么要设计可重入锁？

可重入锁: 获取锁的线程可以重复进入, 每次进入计数+1, 出去计数-1, 计数为0, 释放锁.

如果一个线程需要重复进入某个同步方法, 就会重复获取线程锁, 就会导致死锁.

ReentrantLock: 代码实现的, 可以指定: 公平锁和非公平锁, 可以指定Condition分组需要唤醒的线程(而不是像Synchronize随机唤醒), 提供中断等待的方法(而Synchronize无法中断).

Synchronize: JVM底层实现. 自从优化之后, 加入轻量级锁,偏向锁之后性能相差不多. 当需要使用上面三个特性时可以使用.

#### Synchronized 和 RecentLock 有什么区别？这两个有没有深入了解源码？

ReentrantLock: 代码实现的, 可以指定: 公平锁和非公平锁, 可以指定Condition分组需要唤醒的线程(而不是像Synchronize随机唤醒), 提供中断等待的方法(而Synchronize无法中断).

Synchronize: JVM底层实现. 自从优化之后, 加入轻量级锁,偏向锁之后性能相差不多. 当需要使用上面三个特性时可以使用.

#### 讲下 Volatile 吧？他是怎样做到同步的？

Volatile(只保证了可见性和有序性,不能保证原子性), 原理:每次修改该值, 都会强制让缓存中的该值失效, 必须重新从主存获取. 根据Happen-before原则, volatile变量的写入先于读取操作.

#### Volatile 为什么不支持原子性？举个例子

volatile a = 0;
a++;

#### Atomic 怎么设计的？有用过里面的类吗？

CAS设计, for循环中使用CAS进行设置.

#### 线程安全类和线程不安全的类，项目使用的时候你会怎么选择？怎么判断项目代码哪里会有线程不安全问题？

是否存在被多个线程访问的风险, 如果存在进行同步化操作.

#### Map、List、Set 分别说下你了解到它们有的线程安全类和线程不安全的类？

Map: HashMap, - ConcurrentHashMap, HashTable,Collections.synchronizedMap()
List: ArrayList, LinkedList -  Vector, Collections.synchronizedList(), CopyOnWriteArrayList,
Set: HashSet - CopyOnWriteHashSet, Collections.synchronizedSet()

#### TreeSet 清楚吗？能详细说下吗？

TreeSet: 底层就是TreeMap, 使用红黑树的操作

#### ThreadLocal 了解吗？项目有用过吗？可以说说

为每一个线程单独存储变量, 空间换时间. 变量存在线程实例内部的ThreadLocalHashMap中, key为ThreadLocal, 内部存储对应的变量. 该Map中使用WeakReference, 保证线程消除时, 对应的引用也会消失.

#### JUC 里面你还知道什么其他的类吗？比如 CountDownLatch、Condition

Condition: 功能类似Object, wait,notify. 可以用于区分不同的线程, 进行分组操作.

CountDownLatch: 特殊的锁, 当内部存在一个计算, 计数为0时, 释放所有堵塞的线程. 一般用于测试和等待初始化操作.

#### 从源码详细说下 Java 里面的线程池吧，使用线程池有什么要注意的地方？你们公司有规范吗？

ThreadPoolExecutor: corePoolSize, maximumPoolSize, keepAliveTime(线程数量大于corePoolSize才生效), workQueue, threadFactory, handler(拒绝策略).

一个任务提交过来, 如果线程数小于corePoolSize, 创建线程进行运行. 否则添加到队列中. 如果队列满了, 就会使用拒绝策略.

newFixedThreadPool: 固定线程数量, 队列长度为Integer.MAX, 容易出现OOM.
newSingleThreadExecutor: 同上.
newCachedThreadPool: 固定线程数量为0, 线程数量为Integer.MAX, 线程数量达到系统限制容易导致OOM.
newScheduledThreadPool: 定时执行线程池. 

### JVM

#### JAVA 类加载器

#### Java 内存结构（注：不是 Java 内存模型，别搞混）

#### 怎么判断对象是否可 GC？Java 对象有哪些引用类型？有什么区别？

#### OOM 出现的有哪些场景？为什么会发生？

#### Minor GC 和 Full GC 有什么区别？分析过 GC 日志吗？

#### 说下你知道的垃圾回收算法

#### 说下你知道的垃圾收集器

#### CMS 和 G1 的区别知道吗？使用场景分别是？你项目中用的是哪个？

#### 你还知道哪些 JVM 调优参数？

#### 假如线上服务发生 OOM，有哪些措施可以找到问题？

#### 假如线上服务 CPU 很高该怎么做？有哪些措施可以找到问题？

#### 假如线上应用频繁发生 Full GC，有哪些措施可以找到问题？

#### 一般线上环境遇到 JVM 问题，你会使用哪些工具来分析？找到问题后又该如何去解决呢？

### Spring

#### 说下你对 Spring 生态的了解？

#### 说下你对 Spring AOP 和 IOC 的理解？看过实现原理吗？

#### 说下 Bean 在 Spring 中的生命周期？

#### 讲下你知道的 Spring 注解有哪些？该什么场景使用？

#### Spring 事务知道吗？有了解过吗？

#### 说下你刚才说的 SpringBoot 吧，你觉得 SpringBoot 有什么优点？

#### SpringBoot 自动化配置是怎么做的？有看过实现源码吗？

#### Spring Boot 中最核心的注解 SpringBootApplication 有看过源码分析过吗？

#### 你的项目中 SpringBoot 用到了哪些和其他技术栈整合的？

#### 使用 Spring 或者 SpringBoot 有遇到过什么印象深刻的问题吗？当时是怎么解决的？

### 数据库

#### 你的项目使用的是什么数据库？

#### 你对数据库了解多少？说下数据库的索引实现和非主键的二级索引

#### 说下 MySQL 的索引原理

#### 讲下 InnoDB 和 MyISAM 的区别？使用场景是？

#### 有和 ElasticSearch 的索引原理对比过吗？

#### 如何判断一个查询 sql 语句是否使用了索引？

#### 数据库事务特性和隔离级别

#### 项目数据库表是你设计的吗？一般要注意什么？如何考虑扩展性？

#### 项目 MySQL 的数据量和并发量有多大？量大后的影响有哪些，有考虑吗？SQL 调优有哪些技巧？

#### 说下你项目里面关于数据库印象最深的一个问题？当时是怎么解决的

### 其他

#### 描述下网页一个 Http 请求，到后端的整个请求过程

#### 有比较过 Http 和 RPC 吗？如果叫你设计一个高性能的 Http 或者 RPC，你会从哪些方面考虑？

#### 项目中我看使用了 xxx （ElasticSearch、Hbase、Redis、Flink 等），有深入了解它们的原理和懂点调优技巧吗？

#### 项目中我看使用了 xxx （ElasticSearch、Hbase、Redis、Mysql 等），有深入了解它们数据同步是怎么做吗？

#### 项目中我看使用了 xxx （ElasticSearch、Hbase、Redis、Mysql 等），有深入了解它们常见的监控指标吗？

#### 如果叫你设计一个秒杀系统，你会从哪些方面考虑？

#### 如果叫你设计一个电商系统，你会从哪些方面考虑？

#### 如果叫你设计一个监控告警系统，你会从哪些方面考虑？